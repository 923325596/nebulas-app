webpackJsonp([6],{"9r/T":function(t,e,n){(function(t){var a=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,a,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,a,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(a,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n("AYvJ"),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(e,n("9AUj"))},AYvJ:function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var a,i,o,s,r,c=1,l={},u=!1,m=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?a=function(t){e.nextTick(function(){h(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){h(t.data)},a=function(t){o.port2.postMessage(t)}):m&&"onreadystatechange"in m.createElement("script")?(i=m.documentElement,a=function(t){var e=m.createElement("script");e.onreadystatechange=function(){h(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):a=function(t){setTimeout(h,0,t)}:(s="setImmediate$"+Math.random()+"$",r=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&h(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",r,!1):t.attachEvent("onmessage",r),a=function(e){t.postMessage(s+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return l[c]=i,a(c),c++},d.clearImmediate=f}function f(t){delete l[t]}function h(t){if(u)setTimeout(h,0,t);else{var e=l[t];if(e){u=!0;try{!function(t){var e=t.callback,a=t.args;switch(a.length){case 0:e();break;case 1:e(a[0]);break;case 2:e(a[0],a[1]);break;case 3:e(a[0],a[1],a[2]);break;default:e.apply(n,a)}}(e)}finally{f(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n("9AUj"),n("V0EG"))},DdED:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("3cXf"),i=n.n(a),o=n("jOGT"),s=n.n(o),r=n("YUCf"),c=n.n(r),l=n("8MJb"),u=n("oAV5"),m=n("9r/T"),d=c.a.Account,f=new c.a.Neb,h=new s.a,p={data:function(){return{pending:!1,value:"",content:"",list:[],detail:[],visible:!1,errorText:"",net:"https://mainnet.nebulas.io",dappAddress:"n1yvgpF2cSsHnBP4j2jQNgSZtSmhJASPZ75",hasExtension:!0,comment:"",id:0,topPopup:!1,message:"",toast:!1}},created:function(){this.switchNet(this.net),this.getCandyDetail()},methods:{switchNet:function(t){f.setRequest(new c.a.HttpRequest(t))},getCandyDetail:function(){var t=this,e=this.$route.params.id;this.id=e;var n=d.NewAccount().getAddressString(),a={function:"get",args:i()([parseInt(e)])};this.pending=!0,f.api.call(n,this.dappAddress,"0","0","1000000","2000000",a).then(function(e){var n=e.result;"null"!==n?(n=JSON.parse(n),t.detail=n,console.log(n),t.pending=!1):t.result=[]}).catch(function(t){return console.log("error:"+t)})},handleSubmit:function(){var t=this,e=this.$route.params.id,n=i()([e,this.comment]);this.nebPayCall("comment",n,"0",function(){t.pending=!0},function(){t.getCandyDetail(),t.pending=!1,t.topPopup=!0,t.comment="",Object(m.setTimeout)(function(){t.topPopup=!1},2e3)})},toggleAgree:function(t,e){var n=this;this.hasExtension||(this.message="请先安装星云扩展钱包插件！",this.showToast());var a=i()([t,e]);this.nebPayCall("toggleAgree",a,"0",function(){n.pending=!0},function(){n.getCandyDetail(),n.pending=!1,n.topPopup=!0,n.comment="",Object(m.setTimeout)(function(){n.topPopup=!1},2e3)})},showToast:function(){var t=this;this.toast=!0,this.toastTimer&&clearTimeout(this.toastTimer),this.toastTimer=Object(m.setTimeout)(function(){t.toast=!1},2e3)},queryByHash:function(t,e){var n=this;f.api.getTransactionReceipt({hash:t}).then(function(t){console.log(t),0===t.status&&(n.message=t.execute_error,n.pending=!1,clearInterval(n.timer)),2===t.status&&(n.pending=!0),1===t.status&&(n.pending=!1,console.error("clear",n.timer),clearInterval(n.timer),n.timer=null,e(t))})},nebPayCall:function(t,e,n,a,i){var o=this;if(this.serialNumber=h.call(this.dappAddress,n,t,e,{listener:function(t){if(Object(u.b)()&&t.txhash){var e=t.txhash;o.timer=setInterval(function(){o.queryByHash(e,i),console.error("timer",o.timer)},5e3)}}}),!Object(u.b)())var s=setInterval(function(){o.queryInterval(function(t){clearInterval(s),a(t.hash),o.timer=setInterval(function(){console.error("timer",o.timer),o.queryByHash(t.hash,i)},5e3)})},3e3)},queryInterval:function(t){h.queryPayInfo(this.serialNumber).then(function(e){console.log("tx result: "+e);var n=JSON.parse(e);console.log(n),"success"===n.msg&&t&&t(n.data)}).catch(function(t){console.log("err",t)})}},components:{Avatar:l.a}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"detail"},[t.pending?n("div",{staticClass:"loading"},[n("mu-circular-progress",{attrs:{size:90,color:"secondary"}})],1):t._e(),t._v(" "),t.topPopup?n("mu-alert",{staticClass:"alert",attrs:{color:"success",delete:"",transition:"mu-scale-transition"}},[n("mu-icon",{attrs:{value:"check_circle"}}),t._v(" 更新成功\n  ")],1):t._e(),t._v(" "),t.toast?n("mu-alert",{staticClass:"mu-alert",attrs:{color:"error",delete:""}},[n("mu-icon",{attrs:{value:"warning"}}),t._v(" "+t._s(t.message)+"\n  ")],1):t._e(),t._v(" "),t.detail.author?n("mu-card",[n("mu-card-title",{attrs:{title:"糖果详情"}}),t._v(" "),n("mu-card-header",{attrs:{title:t.detail.title,subTitle:"By:"+t.detail.author}}),t._v(" "),n("mu-divider"),t._v(" "),n("mu-card-text",{domProps:{innerHTML:t._s(t.detail.description)}}),t._v(" "),n("mu-divider"),t._v(" "),n("mu-card-text",[n("mu-list",[n("mu-sub-header",[t._v("评论")]),t._v(" "),t.detail.comments.length?t._e():n("mu-card-text",[t._v("暂无评论")]),t._v(" "),t._l(t.detail.comments,function(e,a){return n("mu-list-item",{key:a,attrs:{avatar:"",button:"",ripple:!1}},[n("mu-list-item-action",[n("mu-avatar",[n("avatar",{attrs:{avatar:e.author}})],1)],1),t._v(" "),n("mu-list-item-title",[t._v(t._s(e.data))])],1)})],2)],1),t._v(" "),n("mu-card-actions",[n("mu-button",{staticClass:"flat-button",attrs:{flat:"",color:"primary"},on:{click:function(e){t.toggleAgree(t.detail.id,!0)}}},[t._v("\n        "+t._s(t.detail.agree.length.toString())+"\n        "),n("mu-icon",{attrs:{right:"",value:"thumb_up"}})],1),t._v(" "),n("mu-button",{staticClass:"flat-button",attrs:{flat:"",color:"secondary"},on:{click:function(e){t.toggleAgree(t.detail.id,!1)}}},[t._v("\n        "+t._s(t.detail.disagree.length.toString())+"\n        "),n("mu-icon",{attrs:{right:"",value:"thumb_down"}})],1)],1),t._v(" "),n("mu-card-actions",[n("mu-text-field",{attrs:{"full-width":"","multi-line":"",rows:1,"rows-max":3,"max-length":500,disabled:!t.hasExtension,placeholder:"这个糖果怎么样...","error-text":t.value?"":t.errorText},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),t._v(" "),n("mu-card-actions",[n("mu-button",{staticClass:"demo-raised-button",attrs:{raised:"",color:"secondary"},on:{click:t.handleSubmit}},[t._v("提交 ")])],1)],1)],1):t._e()],1)},staticRenderFns:[]};var g=n("vSla")(p,v,!1,function(t){n("FJTR")},null,null);e.default=g.exports},FJTR:function(t,e){}});
//# sourceMappingURL=6.81afe9fc6c50ecae766a.js.map