{"version":3,"sources":["webpack:///src/components/candy/List.vue","webpack:///./src/components/candy/List.vue?caa6","webpack:///./src/components/candy/List.vue"],"names":["Account","_nebulas_0_5_0_nebulas_default","a","neb","Neb","nebPay","nebpay_default","List","data","value","content","list","detail","visible","errorText","net","dappAddress","hasExtension","id","topPopup","pending","message","toast","created","this","switchNet","getCandyList","methods","handleChange","console","log","currentIndex","netArr","findIndex","item","address","setRequest","HttpRequest","_this","from","NewAccount","getAddressString","contract","function","args","api","call","then","res","result","JSON","parse","catch","err","selectItem","$router","push","path","showToast","_this2","toastTimer","clearTimeout","setTimeout","hideToast","queryByHash","hash","successCb","_this3","getTransactionReceipt","receipt","status","execute_error","clearInterval","timer","error","nebPayCall","callFunc","callArgs","cb","_this4","serialNumber","listener","Object","utils","txhash","setInterval","queryTimer","queryInterval","queryPayInfo","resObj","msg","components","Avatar","candy_List","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","size","_e","_v","z-depth","_l","index","key","avatar","button","ripple","on","click","$event","author","_s","title","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/15.a66cc99dba283ec60164.js","sourcesContent":["<template>\n  <div class=\"body\">\n    <div class=\"loading\" v-if=\"pending\">\n       <mu-circular-progress :size=\"90\" />\n    </div>\n    <div class=\"list\" v-if=\"list.length\">\n      <mu-paper :z-depth=\"1\" class=\"list-wrap\">\n        <mu-list>\n          <mu-sub-header>糖果列表</mu-sub-header>\n          <mu-list-item\n            avatar button :ripple=\"false\"\n            v-for=\"(item, index) in list\"\n            @click=\"selectItem(item)\"\n            :key=\"index\">\n            <mu-list-item-action>\n              <mu-avatar>\n                <avatar :avatar=\"item.author\"></avatar>\n              </mu-avatar>\n            </mu-list-item-action>\n            <mu-list-item-title>{{item.title}}</mu-list-item-title>\n          </mu-list-item>\n        </mu-list>\n      </mu-paper>\n    </div>\n  </div>\n</template>\n\n<script>\nimport NebPay from 'nebpay.js';\nimport Nebulas from 'nebulas';\nimport { isPC } from '../../utils/utils';\nimport Avatar from '../../common/Avatar';\n\nconst Account = Nebulas.Account;\nconst neb = new Nebulas.Neb();\nconst nebPay = new NebPay();\nexport default {\n  data () {\n    return {\n      value: '',\n      content: '',\n      list: [],\n      detail: [],\n      visible: false,\n      errorText: '',\n      net: 'https://mainnet.nebulas.io',\n      dappAddress: 'n1yvgpF2cSsHnBP4j2jQNgSZtSmhJASPZ75',\n      hasExtension: true,\n      id: 0,\n      topPopup: false,\n      pending: false,\n      message: '',\n      toast: false\n    };\n  },\n  created () {\n    this.switchNet(this.net);\n    this.getCandyList();\n  },\n  methods: {\n    handleChange (value) {\n      console.log(value);\n      this.net = value;\n      const currentIndex = this.netArr.findIndex((item) => item.value === value);\n      this.dappAddress = this.netArr[currentIndex].address;\n      this.switchNet(value);\n    },\n    switchNet (value) {\n      // neb.setRequest(new Nebulas.HttpRequest(\"localhost:8685\"));\n      console.log(value);\n      neb.setRequest(new Nebulas.HttpRequest(value));\n    },\n    getCandyList () {\n      const from = Account.NewAccount().getAddressString();\n      const value = '0';\n      const nonce = '0';\n      const gasPrice = '1000000';\n      const gasLimit = '2000000';\n      const callFunc = 'list';\n      const callArgs = '';\n      const contract = {\n        function: callFunc,\n        args: callArgs\n      };\n      this.pending = true;\n      neb.api.call(from, this.dappAddress, value, nonce, gasPrice, gasLimit, contract).then((res) => {\n        this.pending = false;\n        let result = res.result;\n        if (result === 'null') {\n          this.result = [];\n          return;\n        }\n        result = JSON.parse(result);\n        this.list = result;\n      }).catch(err => console.log(`error:${err}`));\n    },\n    selectItem (item) {\n      this.$router.push({\n        path: `/candy/detail/${item.id}`\n      });\n    },\n    showToast () {\n      this.toast = true;\n      if (this.toastTimer) clearTimeout(this.toastTimer);\n      this.toastTimer = setTimeout(() => { this.toast = false; }, 2000);\n    },\n    hideToast () {\n      this.toast = false;\n      if (this.toastTimer) clearTimeout(this.toastTimer);\n    },\n    queryByHash (hash, successCb) {\n      neb.api.getTransactionReceipt({hash}).then((receipt) => {\n        console.log(receipt);\n        if (receipt.status === 0) {\n          this.message = receipt.execute_error;\n          this.pending = false;\n          clearInterval(this.timer);\n        }\n        if (receipt.status === 2) {\n          this.pending = true;\n        }\n        if (receipt.status === 1) {\n          this.pending = false;\n          console.error('clear', this.timer);\n          clearInterval(this.timer);\n          this.timer = null;\n          successCb(receipt);\n        }\n      });\n    },\n\n    nebPayCall (callFunc, callArgs, value, cb, successCb) {\n      this.serialNumber = nebPay.call(this.dappAddress, value, callFunc, callArgs, {\n        listener: (res) => {\n          if (!isPC()) {\n            return;\n          }\n          if (res.txhash) {\n            const hash = res.txhash;\n            this.timer = setInterval(() => {\n              this.queryByHash(hash, successCb);\n              console.error('timer', this.timer);\n            }, 5000);\n          }\n        }\n      });\n      if (!isPC()) {\n        const queryTimer = setInterval(() => {\n          const queryCb = (data) => {\n            clearInterval(queryTimer);\n            cb(data.hash);\n            this.timer = setInterval(() => {\n              console.error('timer', this.timer);\n              this.queryByHash(data.hash, successCb);\n            }, 5000);\n          };\n          this.queryInterval(queryCb);\n        }, 3000);\n      }\n    },\n\n    queryInterval (cb) {\n      nebPay.queryPayInfo(this.serialNumber)\n        .then(res => {\n          console.log(`tx result: ${res}`);\n          const resObj = JSON.parse(res);\n          console.log(resObj);\n          if (resObj.msg === 'success') {\n            cb && cb(resObj.data);\n          }\n        })\n        .catch(function (err) {\n          console.log('err', err);\n        });\n    }\n  },\n  components: {\n    Avatar\n  }\n};\n</script>\n\n<style>\n.body{\n  background-color: white;\n  border-radius: 5px;\n  min-height: 900px;\n  padding: 50px;\n}\n\n.mu-avatar {\n  width: 50px !important;\n  height: 50px !important;\n}\n\n.app-row {\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n}\n\n.left, .right {\n  flex: 1;\n}\n\n.content {\n  padding-bottom:100px;\n}\n\n.row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.detail {\n  margin-top: 20px;\n}\n\n.card-content {\n  padding: 16px;\n}\n\n.mu-text-field {\n  width: 100%;\n}\n\n.author {\n  font-size: 14px;\n  color: #666;\n  margin-right: 5px;\n}\n\n.list-wrap {\n  width: 100%;\n}\n\n.loading {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: rgba(0, 0, 0, 0.3);\n  z-index: 9999;\n}\n\n@media screen and (max-width: 768px) {\n    .body {\n       padding: 20px 20px 0 20px;\n    }\n    .app-row, .row {\n      flex-direction: column;\n      justify-content: flex-start;\n      align-items: flex-start;\n    }\n    .card {\n      margin: 0 0 20px 0;\n    }\n    .left, .right {\n      width: 100%;\n    }\n    .right {\n      padding: 0px;\n      margin-left: 0;\n      margin-top: 20px;\n    }\n    .mu-card-sub-title {\n      max-width: 250px;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/candy/List.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"body\"},[(_vm.pending)?_c('div',{staticClass:\"loading\"},[_c('mu-circular-progress',{attrs:{\"size\":90}})],1):_vm._e(),_vm._v(\" \"),(_vm.list.length)?_c('div',{staticClass:\"list\"},[_c('mu-paper',{staticClass:\"list-wrap\",attrs:{\"z-depth\":1}},[_c('mu-list',[_c('mu-sub-header',[_vm._v(\"糖果列表\")]),_vm._v(\" \"),_vm._l((_vm.list),function(item,index){return _c('mu-list-item',{key:index,attrs:{\"avatar\":\"\",\"button\":\"\",\"ripple\":false},on:{\"click\":function($event){_vm.selectItem(item)}}},[_c('mu-list-item-action',[_c('mu-avatar',[_c('avatar',{attrs:{\"avatar\":item.author}})],1)],1),_vm._v(\" \"),_c('mu-list-item-title',[_vm._v(_vm._s(item.title))])],1)})],2)],1)],1):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-28675df8\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/components/candy/List.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-28675df8\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=styles&index=0!./List.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./List.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./List.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-28675df8\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=template&index=0!./List.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/candy/List.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}